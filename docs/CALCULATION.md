# 薪資計算規則

本文件定義薪資計算系統的計算邏輯與規則。

> **重要提示**: 本文件為預設範本，實際計算規則需與使用者確認後更新。

---

## 1. 基本設定

### 1.1 薪資制度
- **預設**: 時薪制
- **可調整**: 可依企業需求調整為月薪制或混合制

### 1.2 正常工時
- **每日正常工時**: 8 小時
- **每週正常工時**: 40 小時
- **每月正常工時**: 約 176 小時（以 22 個工作天計算）

### 1.3 時薪計算
- **時薪**: 由使用者設定，或從員工資料表讀取
- **預設時薪**: 200 元（範例用）

---

## 2. 工時計算

### 2.1 實際工時計算

```
實際工時 = 下班打卡時間 - 上班打卡時間 - 休息時間
```

#### 休息時間規則
- 工作超過 4 小時：休息 30 分鐘
- 工作超過 8 小時：休息 1 小時

#### 範例
- 上班 08:30，下班 17:30
- 工作時間 = 9 小時
- 休息時間 = 1 小時
- **實際工時 = 8 小時**

### 2.2 加班工時計算

```
加班工時 = 實際工時 - 預定工時
```

#### 條件
- 僅當實際工時 > 預定工時時計算加班
- 加班需符合勞基法規定（每日最多 12 小時、每月最多 46 小時）

#### 範例
- 預定工時 = 8 小時
- 實際工時 = 10 小時
- **加班工時 = 2 小時**

---

## 3. 薪資計算

### 3.1 正常工時薪資

```
正常工時薪資 = 正常工時 × 時薪
```

#### 範例
- 正常工時 = 176 小時
- 時薪 = 200 元
- **正常工時薪資 = 35,200 元**

### 3.2 加班費計算

依照《勞動基準法》第 24 條規定：

#### 平日加班
- **前 2 小時**: 時薪 × 1.34 倍
- **第 3 小時起**: 時薪 × 1.67 倍

#### 例假日加班
- **全日**: 時薪 × 2 倍

#### 國定假日加班
- **全日**: 時薪 × 2 倍

#### 範例（平日加班 3 小時）
- 時薪 = 200 元
- 前 2 小時 = 200 × 1.34 × 2 = 536 元
- 第 3 小時 = 200 × 1.67 × 1 = 334 元
- **加班費 = 870 元**

### 3.3 總薪資

```
總薪資 = 正常工時薪資 + 加班費 + 津貼 - 扣款
```

---

## 4. 異常處理

### 4.1 缺卡處理

#### 情況 A：有班表但無打卡
- **標記**: 異常「缺卡」
- **預設處理**: 不計算該日工時
- **可調整**: 人工於調整頁面補登

#### 情況 B：僅缺上班或下班打卡
- **標記**: 異常「缺上班打卡」或「缺下班打卡」
- **預設處理**: 
  - 缺上班打卡：假設準時上班
  - 缺下班打卡：假設準時下班
- **可調整**: 人工於調整頁面修正

### 4.2 遲到處理

#### 定義
上班打卡時間 > 班表上班時間

#### 處理方式
- **標記**: 異常「遲到」，記錄遲到分鐘數
- **工時計算**: 以實際打卡時間計算
- **扣款**: （可選）依企業規定設定遲到扣款規則

#### 範例
- 班表上班時間：08:00
- 實際打卡時間：08:15
- **遲到 15 分鐘**

### 4.3 早退處理

#### 定義
下班打卡時間 < 班表下班時間

#### 處理方式
- **標記**: 異常「早退」，記錄早退分鐘數
- **工時計算**: 以實際打卡時間計算
- **扣款**: （可選）依企業規定設定早退扣款規則

#### 範例
- 班表下班時間：17:30
- 實際打卡時間：17:00
- **早退 30 分鐘**

### 4.4 缺勤處理

#### 定義
班表有排班，但完全無打卡紀錄

#### 處理方式
- **標記**: 異常「缺勤」
- **工時計算**: 該日工時 = 0
- **扣款**: （可選）依企業規定設定缺勤扣款規則

---

## 5. 津貼與扣款

### 5.1 津貼項目（可選）

| 津貼名稱 | 計算方式 | 說明 |
|---------|---------|------|
| 全勤獎金 | 固定金額 | 當月無遲到早退缺勤 |
| 伙食津貼 | 固定金額或依工作天數 | 每日 100 元 |
| 交通津貼 | 固定金額 | 每月固定 |
| 職務加給 | 固定金額 | 依職位不同 |

### 5.2 扣款項目（可選）

| 扣款名稱 | 計算方式 | 說明 |
|---------|---------|------|
| 勞保費 | 薪資 × 比例 | 依勞保局規定 |
| 健保費 | 薪資 × 比例 | 依健保局規定 |
| 所得稅 | 薪資 × 比例 | 依稅法規定 |
| 遲到扣款 | 每次固定金額或依時間計算 | 依企業規定 |
| 事假扣款 | 時薪 × 請假時數 | 依企業規定 |

---

## 6. 特殊情況

### 6.1 跨日班次

#### 定義
上班與下班打卡時間跨越午夜 00:00

#### 處理方式
- 自動判斷跨日
- 計算實際工時 = (24:00 - 上班時間) + 下班時間

#### 範例
- 上班：23:00
- 下班：02:00（隔日）
- **工時 = 3 小時**

### 6.2 國定假日

#### 定義
依照人事行政局公告的國定假日

#### 處理方式
- 若該日有排班且有打卡，加班費率 × 2
- 可於系統設定檔維護國定假日清單

### 6.3 例假日

#### 定義
勞基法規定的例假日（通常為週日）

#### 處理方式
- 若該日有排班且有打卡，加班費率 × 2

---

## 7. 計算流程

```
1. 讀取班表與打卡紀錄
   ↓
2. 依員工編號與日期比對
   ↓
3. 計算每日實際工時
   ↓
4. 判斷正常工時與加班工時
   ↓
5. 檢查異常情況（缺卡、遲到、早退）
   ↓
6. 計算薪資（正常工時薪資 + 加班費）
   ↓
7. 加入津貼、扣除扣款
   ↓
8. 產生薪資明細
```

---

## 8. 計算範例

### 範例 1：正常上班

| 項目 | 內容 |
|------|------|
| 員工編號 | E001 |
| 員工姓名 | 張三 |
| 時薪 | 200 元 |
| 工作天數 | 22 天 |
| 總工時 | 176 小時 |
| 正常工時 | 176 小時 |
| 加班工時 | 0 小時 |
| 正常工時薪資 | 35,200 元 |
| 加班費 | 0 元 |
| 津貼 | 0 元 |
| 扣款 | 0 元 |
| **總薪資** | **35,200 元** |

### 範例 2：有加班

| 項目 | 內容 |
|------|------|
| 員工編號 | E002 |
| 員工姓名 | 李四 |
| 時薪 | 200 元 |
| 工作天數 | 22 天 |
| 總工時 | 186 小時 |
| 正常工時 | 176 小時 |
| 加班工時 | 10 小時（平日前 2 小時 × 5 天） |
| 正常工時薪資 | 35,200 元 |
| 加班費 | 200 × 1.34 × 10 = 2,680 元 |
| 津貼 | 全勤獎金 2,000 元 |
| 扣款 | 0 元 |
| **總薪資** | **39,880 元** |

### 範例 3：有異常

| 項目 | 內容 |
|------|------|
| 員工編號 | E003 |
| 員工姓名 | 王五 |
| 時薪 | 200 元 |
| 工作天數 | 20 天（缺勤 2 天） |
| 總工時 | 160 小時 |
| 正常工時 | 160 小時 |
| 加班工時 | 0 小時 |
| 正常工時薪資 | 32,000 元 |
| 加班費 | 0 元 |
| 津貼 | 0 元（因缺勤無全勤獎金） |
| 扣款 | 遲到 3 次 × 100 = 300 元 |
| **總薪資** | **31,700 元** |
| **異常記錄** | 遲到 3 次、缺勤 2 天 |

---

## 9. 待確認項目

以下項目需與使用者確認：

1. ☐ 時薪金額或如何取得時薪資料
2. ☐ 加班費率是否符合企業規定
3. ☐ 休息時間規則
4. ☐ 遲到/早退/缺勤的扣款規則
5. ☐ 津貼項目與計算方式
6. ☐ 是否需要處理國定假日與例假日
7. ☐ 跨日班次的處理方式
8. ☐ 其他特殊情況

---

**更新日期**: 2024-01-01  
**狀態**: 待確認
