# Excel 檔案格式定義

本文件定義薪資計算系統所需的 Excel 檔案格式。

---

## 1. 班表 Excel

### 檔案命名建議
`班表YYYYMM.xlsx`（例如：班表202401.xlsx）

### 工作表名稱
`班表` 或 `Sheet1`（第一個工作表）

### 必要欄位

| 欄位名稱 | 欄位代號 | 資料類型 | 必填 | 說明 | 範例 |
|---------|---------|---------|------|------|------|
| 員工編號 | A | 文字 | 是 | 唯一識別碼 | E001 |
| 員工姓名 | B | 文字 | 是 | 員工姓名 | 張三 |
| 日期 | C | 日期 | 是 | 班表日期 | 2024/01/01 |
| 班別 | D | 文字 | 是 | 早班/晚班/休假 | 早班 |
| 預定工作時數 | E | 數字 | 是 | 該日預定工時 | 8 |

### 選用欄位

| 欄位名稱 | 欄位代號 | 資料類型 | 必填 | 說明 | 範例 |
|---------|---------|---------|------|------|------|
| 部門 | F | 文字 | 否 | 部門名稱 | 業務部 |
| 備註 | G | 文字 | 否 | 其他說明 | 國定假日 |

### 範例

| A | B | C | D | E | F | G |
|---|---|---|---|---|---|---|
| 員工編號 | 員工姓名 | 日期 | 班別 | 預定工作時數 | 部門 | 備註 |
| E001 | 張三 | 2024/01/01 | 早班 | 8 | 業務部 | |
| E001 | 張三 | 2024/01/02 | 晚班 | 8 | 業務部 | |
| E001 | 張三 | 2024/01/03 | 休假 | 0 | 業務部 | 特休 |
| E002 | 李四 | 2024/01/01 | 早班 | 8 | 行政部 | |

### 資料驗證規則

1. **員工編號**: 不可空白，建議使用英數字組合
2. **員工姓名**: 不可空白
3. **日期**: 必須為有效日期格式（YYYY/MM/DD 或 YYYY-MM-DD）
4. **班別**: 不可空白，建議使用固定值（早班、晚班、休假等）
5. **預定工作時數**: 必須為數字，範圍 0-24

---

## 2. 打卡紀錄 Excel

### 檔案命名建議
`打卡紀錄YYYYMM.xlsx`（例如：打卡紀錄202401.xlsx）

### 工作表名稱
`打卡紀錄` 或 `Sheet1`（第一個工作表）

### 必要欄位

| 欄位名稱 | 欄位代號 | 資料類型 | 必填 | 說明 | 範例 |
|---------|---------|---------|------|------|------|
| 員工編號 | A | 文字 | 是 | 唯一識別碼（需與班表一致） | E001 |
| 日期 | B | 日期 | 是 | 打卡日期 | 2024/01/01 |
| 上班打卡時間 | C | 時間 | 否* | 上班打卡時間 | 08:30 |
| 下班打卡時間 | D | 時間 | 否* | 下班打卡時間 | 17:45 |

*註：上班打卡時間與下班打卡時間至少需有一個

### 選用欄位

| 欄位名稱 | 欄位代號 | 資料類型 | 必填 | 說明 | 範例 |
|---------|---------|---------|------|------|------|
| 員工姓名 | E | 文字 | 否 | 員工姓名（供核對用） | 張三 |
| 備註 | F | 文字 | 否 | 其他說明 | 外出洽公 |

### 範例

| A | B | C | D | E | F |
|---|---|---|---|---|---|
| 員工編號 | 日期 | 上班打卡時間 | 下班打卡時間 | 員工姓名 | 備註 |
| E001 | 2024/01/01 | 08:30 | 17:45 | 張三 | |
| E001 | 2024/01/02 | 08:25 | 18:30 | 張三 | 加班 |
| E001 | 2024/01/03 | | | 張三 | 特休 |
| E002 | 2024/01/01 | 08:35 | | 李四 | 缺下班打卡 |

### 資料驗證規則

1. **員工編號**: 不可空白，必須與班表中的員工編號一致
2. **日期**: 必須為有效日期格式（YYYY/MM/DD 或 YYYY-MM-DD）
3. **上班打卡時間**: 時間格式 HH:MM 或 HH:MM:SS
4. **下班打卡時間**: 時間格式 HH:MM 或 HH:MM:SS
5. **時間邏輯**: 下班打卡時間應晚於上班打卡時間（跨日除外）

---

## 3. 時間格式說明

### 支援的日期格式
- `YYYY/MM/DD`（例如：2024/01/01）
- `YYYY-MM-DD`（例如：2024-01-01）
- Excel 日期序號（例如：45292）

### 支援的時間格式
- `HH:MM`（例如：08:30）
- `HH:MM:SS`（例如：08:30:00）
- Excel 時間序號（例如：0.354166667）

### 跨日處理
若下班打卡時間早於上班打卡時間，系統會自動判斷為跨日（例如：23:00 上班，02:00 下班 → 工時 3 小時）

---

## 4. 常見問題

### Q1: 員工編號可以包含中文嗎？
**A**: 可以，但建議使用英數字組合，避免編碼問題。

### Q2: 如果某日員工請假，班表和打卡紀錄該如何填寫？
**A**: 
- 班表：班別填「休假」，預定工作時數填 0
- 打卡紀錄：可不填該日資料，或上下班打卡時間留空

### Q3: 如果員工忘記打卡怎麼辦？
**A**: 
- 打卡紀錄中該欄位留空
- 系統會標記為「缺卡」異常
- 後續可在調整頁面手動修正

### Q4: 時間格式錯誤會怎樣？
**A**: 系統會在上傳時進行驗證，若格式錯誤會回傳錯誤訊息，請修正後重新上傳。

### Q5: 可以上傳多個月份的資料嗎？
**A**: 可以，但建議分月份上傳，方便管理與查詢。

---

## 5. 範例檔案

測試用範例檔案位於專案的 `test-data/` 目錄：

- `sample-schedule.xlsx`: 範例班表
- `sample-attendance.xlsx`: 範例打卡紀錄

---

**更新日期**: 2024-01-01
